let input = "2365712272-2390766206\n2569947483-2579668543\n1348241901-1362475328\n2431265968-2450509895\n2146385-2259474\n2935960035-2940597034\n448888033-460770571\n1993433098-1995841061\n1479295247-1481053053\n2315798162-2331724795\n553124643-558300256\n2221609952-2221736791\n2528284970-2536413665\n1003828483-1008019254\n2460073010-2461391392\n1756403373-1774263374\n181708677-181820620\n4105906368-4108964079\n2803753677-2810396331\n3872622758-3876157728\n4222455331-4230019102\n2566685080-2569947482\n2546666999-2560222508\n2563776047-2567373420\n669206125-670672126\n3047016482-3068254467\n2412767568-2415681466\n3832227190-3836056110\n1752672085-1778896581\n3612964446-3613428692\n473462452-473507720\n558414399-558825886\n174888587-188726755\n3681687609-3688894180\n482298773-513769024\n1105376539-1109259196\n2626549708-2635018162\n2221569800-2221688559\n3217908441-3218365608\n1839378196-1839704131\n4006631148-4018637666\n1033070477-1039079720\n3614366173-3619803122\n1651631132-1657688516\n3148614241-3149307836\n2922404131-2925650734\n2967474818-2979959263\n3674334884-3677432948\n2194863661-2195245017\n1723397977-1746877683\n246394156-253325513\n577459246-594741177\n410425445-412372582\n1287281042-1288450150\n2546572083-2552459138\n3284505169-3292205355\n2572957308-2615378907\n2689345749-2699114021\n3296227141-3297518289\n3695819772-3697468770\n412372583-422306605\n2699114022-2714857638\n2059138236-2060952632\n117089981-120121935\n2848444484-2857342976\n352052590-358986830\n2656447256-2685668729\n454980721-460461657\n1027539209-1041751363\n1913417-3826887\n1062494257-1082863054\n2282966419-2286017938\n394757734-421655845\n2106693263-2115236723\n1124719891-1127653202\n3292205357-3293681013\n117011952-119543627\n2181915940-2184656064\n1045705528-1078679114\n290113491-291311039\n2278026399-2284902493\n841914150-848969885\n3952731875-3959197013\n1938643863-1940674602\n1036550327-1041084034\n63607243-63644812\n3769265734-3769975585\n51653989-55144083\n1799892196-1812471751\n1371739118-1372165373\n3561636732-3569279384\n1823678708-1830435069\n4012340693-4047186502\n3697468771-3719107288\n1963424400-1964720496\n254179574-261945026\n2639565460-2643861101\n2489776747-2498561347\n1528974499-1529888310\n2272121277-2279366265\n2063178650-2063502047\n2631423649-2635927617\n1360641171-1369732967\n352866001-362403909\n2982988833-2999220870\n2226316378-2236701767\n3581998091-3588302160\n3905167888-3909688736\n2410405177-2416922214\n2221793009-2222205811\n1682009735-1689579607\n2551217715-2555588513\n4111825736-4139764825\n1495499947-1496504480\n1126815599-1132033603\n262946528-267481743\n2190431207-2194125961\n3056852838-3057666713\n3852657771-3855744213\n814188270-815660610\n1370082674-1372874146\n2698266605-2707295552\n2623491116-2632182274\n556237979-558470744\n4221727965-4242434586\n1373248698-1389927798\n3269334240-3276265066\n2266535688-2268367969\n3098582122-3101205009\n1909408103-1909548530\n2822711293-2831177968\n848969887-859626993\n46887186-54157057\n2762897904-2771117185\n289933294-290354931\n1088830930-1093432672\n2443230763-2461276873\n3160139479-3173260442\n1527097290-1531435951\n1799540955-1800006056\n1369732968-1371815843\n2622838271-2625104782\n1173393865-1173503336\n1909254997-1910983838\n1299664180-1322001993\n1688665208-1691812251\n1887810466-1890884113\n2869886503-2875645396\n582392092-606025972\n4267022320-4275265906\n3859201994-3893484463\n3589262267-3596650599\n912537182-912907636\n2221654107-2222088287\n4057523345-4060042618\n3697080984-3697115223\n970916665-977773714\n1357371244-1357771399\n300561490-351155869\n1312775715-1335513565\n117013732-119708846\n425465828-460547231\n1934707608-1943900203\n1872455505-1883131224\n1265429510-1270058235\n1351349572-1360842989\n3949672363-3965375662\n757393179-769131755\n1140550254-1155907063\n2362581541-2384858143\n3767349312-3769448384\n1010152192-1021680403\n3719107290-3724947612\n793186065-798493071\n3543437818-3570393128\n2142580414-2155598642\n570014715-594180691\n2268145476-2268275380\n682993360-688547687\n882429283-885295513\n2061317899-2062340917\n3080454969-3087996304\n1509787381-1515229305\n1792788995-1805479181\n471893034-478588629\n2469289299-2469834064\n3435184443-3439758093\n1972314440-1984109813\n897623204-906019235\n3309685433-3316891985\n2022851-2168311\n3425944138-3434725507\n1573705848-1574774103\n1843461004-1851252409\n275830302-287491224\n1099676859-1106356804\n3201885249-3216240573\n890516875-914189870\n1045475561-1045705526\n858602633-861745342\n1722754472-1729362918\n1999030390-2001346788\n2295812200-2297395314\n545671618-547361797\n1925762580-1932504567\n2469834065-2488585001\n962891401-973508116\n3056544703-3057098061\n1964666710-1968283715\n4153249699-4156067673\n2269509587-2272121275\n113577026-129098597\n2544925116-2547575012\n3930954397-3932696547\n1940360721-1941087983\n989005807-1006335777\n1715546619-1723575645\n946249856-956419020\n2580089074-2609078369\n118138523-133562721\n1418940971-1433573243\n3116049988-3117047351\n2819201530-2820204193\n609029102-631859346\n1236996385-1243667312\n2071060282-2090563034\n3275297026-3287385948\n557242553-558842013\n2340595893-2346006065\n1763694009-1772957054\n3039028781-3066739550\n2678983882-2689345747\n1496448610-1497010926\n3783756301-3783968438\n4011127020-4023009734\n2455737032-2469289297\n911816966-912509075\n2275917994-2288190359\n1405416423-1419176714\n2642680237-2644300616\n3826507233-3826769507\n3791085814-3803870306\n3990925848-3994761120\n1574446563-1576228425\n1634308286-1635388054\n3770072854-3783827763\n859626994-872001663\n1678998549-1682009733\n3615640609-3625220434\n3756046034-3759831577\n4219956234-4225730655\n1944691819-1972314439\n3232924024-3243647347\n2819804415-2821623032\n1041187113-1041438684\n1234384868-1251566238\n1707319358-1710481231\n3338081719-3342039539\n3919045080-3932932694\n1618322267-1618915594\n1196499550-1204759606\n354238054-359105442\n2788225259-2807617695\n1817797800-1818404115\n3314463142-3319629375\n3220899130-3223901824\n463163318-471893033\n2108731258-2118466370\n2531905696-2534895562\n872001665-885348477\n3618924494-3633614536\n1286808229-1287787318\n1686812571-1709789731\n1667289113-1675800071\n1288046293-1288760085\n115133053-118531268\n3084925009-3087972171\n2107005650-2118671640\n2206689406-2208120987\n2965687206-2969477736\n2789286984-2795621824\n1510800557-1520242850\n1372577266-1373248696\n3908185397-3914112662\n3027341861-3028862050\n2551506862-2563776045\n3457830284-3476082138\n2330638928-2335068417\n3754091818-3760153804\n1700898897-1708456845\n2653919552-2678983881\n1718586248-1752672083\n1909974346-1911447514\n740859879-743318742\n632094677-641123609\n2717310519-2722969125\n2429156614-2450453303\n3573769011-3581998089\n804909837-807598669\n2645933387-2650206634\n3906744049-3908084382\n1088710392-1093793913\n2945948817-2961003764\n2154975171-2170652704\n705358087-723167844\n2623774017-2637924339\n1527448631-1531925852\n541284581-550148134\n822228123-845259076\n2725319909-2726283018\n90504693-97857953\n2151018859-2156845889\n3875175237-3880661438\n2174472127-2175522174\n1053913106-1073312877\n4151957167-4159217706\n408096359-410929997\n3494935822-3518493936\n4018415387-4034413199\n1318527150-1335393593\n4094276281-4100264566\n3296618992-3305730207\n3827540382-3834020598\n1792716600-1804353554\n486286244-509649426\n2820166268-2822489545\n943117353-944243402\n4250879477-4288162587\n1092150174-1096445797\n659715146-669206123\n424405829-425465827\n2903268723-2916344920\n2825756580-2827850093\n2197813619-2221567221\n2222205813-2242661939\n1909398015-1909639813\n2085646-2171133\n3237410359-3243293444\n2488585003-2500532520\n1719496111-1733109286\n3101107881-3101724703\n4292290133-4294130012\n2682533716-2682557737\n478588631-499658423\n2056703122-2057132500\n10759205-22974868\n288949273-290120633\n3295342764-3300711505\n4144392189-4146507469\n1377845154-1383061661\n1470042236-1484545053\n2929570686-2942193911\n663447966-667304777\n2250137488-2260767053\n2916852498-2920130617\n560916716-582392091\n3826421034-3826753059\n4205391625-4209582225\n3098065613-3099195513\n1523618109-1529220622\n1280876899-1287180580\n2896461712-2914779142\n3059619066-3072535463\n3594066104-3603694944\n206442883-222778068\n4057343389-4058593137\n3040726007-3067509699\n783978732-804864426\n3782497016-3783855888\n3771309186-3798156648\n1806086747-1808455979\n2509648237-2520128379\n2655519435-2688778011\n466454947-475885979\n764443451-778431348\n942699799-943817373\n2707406125-2710335531\n3532789271-3534889466\n161216255-168066537\n3959810178-3972378256\n1216245-1730562\n820810878-827132162\n3840466779-3849871670\n241662240-244306234\n1308539-1732730\n2644300617-2653919550\n1245139600-1257000695\n472344288-476821359\n360421650-365291918\n4157074002-4160043617\n3475229162-3494935820\n4021239535-4026837101\n1122221983-1122467302\n3524503684-3534615536\n294914250-297074740\n3315785542-3320016807\n3207399725-3218904107\n3399796042-3432628902\n2415031178-2417587472\n637037746-641909503\n4125051011-4125349366\n2792226042-2796333812\n1090609063-1093811054\n3826753967-3826928901\n2845981709-2846071766\n1884551628-1888679834\n1867383722-1901804607\n1138049177-1150698174\n2489168484-2503275369\n3844741449-3859201992\n2059227603-2061190162\n2725980853-2726316169\n3950461578-3982076979\n2964040486-2971816053\n3117022269-3125872507\n4205459617-4208901905\n3223901825-3259939574\n2043681871-2056703120\n2862497588-2874433217\n1545573025-1550810115\n558470745-560916714\n2204957059-2206941462\n687956243-693820818\n1006335778-1027539207\n1683104091-1691973027\n1281662230-1286185165\n2457027525-2467523425\n3910944384-3915139260\n1812471753-1823678707\n3439758094-3449375742\n4180271874-4183028052\n3145750655-3149232555\n1063127835-1081739469\n912453784-912787957\n757841367-763656320\n970465196-984461751\n2682535644-2682561899\n1103041548-1124501094\n711829065-712418631\n786434450-810431275\n526718776-547605908\n411642224-419649420\n442563986-451494166\n3916556398-3932893207\n4178915874-4181659654\n931371848-932759051\n226571744-227466085\n586436371-589611958\n2138685204-2148239206\n2786369133-2807032221\n3902400566-3910944383\n356708623-360421649\n1195358721-1201587206\n2986693403-2997511709\n1160749272-1164268031\n1138794253-1160582337\n1316625314-1322081912\n2546426233-2547478858\n631117298-638088180\n490462991-510876262\n1585596253-1598442115\n1691404689-1708777514\n21958182-34768708\n3033283449-3033532644\n850358573-850941928\n2532323467-2533835875\n2571607510-2576905211\n3838468698-3844741448\n3633614538-3658935402\n1267571462-1273337904\n820046167-821948762\n1818557964-1821003970\n1656682467-1658689820\n3572000906-3576107308\n3518493937-3521124207\n2316622941-2320028763\n3234261481-3244439202\n1762170451-1767000441\n403695570-413282241\n1446563227-1455229013\n994814766-1020194067\n1103304248-1123109762\n1358159388-1364262240\n2643072595-2647827063\n1761152300-1771038779\n814235534-818070036\n3658935403-3674334882\n1143690782-1167938223\n956027555-959929296\n78736212-103134510\n897919912-910244590\n991162491-1009670900\n3730115132-3731119302\n3693059535-3697085999\n310695719-311355138\n3792190887-3811128942\n3236342985-3241419480\n932285275-939464714\n1690112643-1694719438\n964486517-974083673\n2886004632-2887772395\n400201502-410632385\n4151877322-4155177505\n4146634947-4148274967\n4142431183-4151685720\n108233930-110782083\n11764001-28124816\n255280185-265644134\n1604894700-1610024510\n2746388028-2755644917\n257526100-265688716\n2979959265-2981174695\n3675625153-3678243537\n946960127-957058942\n158966202-168896939\n885386378-890516873\n3944559186-3950461577\n3436884337-3440035586\n1998995929-2004489839\n1029028825-1029925818\n860116537-869330710\n534657657-536577765\n2792605215-2809178574\n83479693-101592615\n206521107-208527729\n3681963513-3682865724\n2913358381-2916852496\n3172620089-3183275609\n649130727-656267839\n1264638271-1274096286\n1029718677-1030140380\n3643603238-3653831146\n3061231145-3063632127\n2585980608-2609955243\n1316394181-1319520040\n211076367-219280164\n3240385969-3251259062\n2120060-4441033\n3278363479-3278515140\n3831551420-3838468696\n1173779057-1176512368\n4071597616-4101375293\n2781084212-2783642342\n2743354447-2760958028\n4114529275-4137230617\n3752969032-3767349311\n424150040-425393208\n26532978-29480043\n1006115405-1009958851\n2845371314-2850260793\n1267920977-1271152591\n3709512503-3716036930\n3368253421-3392905399\n2452693801-2465509837\n3534255481-3543437816\n4160043619-4178915873\n3954591115-3974152768\n677298953-691027000\n1685806773-1690772816\n436652774-450179768\n3588302161-3612662806\n83367242-100910390\n1633907668-1651631131\n443592135-463163316\n369907897-388846763\n388962875-390004346\n2306861374-2315798161\n591078-868213\n1229951959-1242298204\n3014332113-3031527143\n1171615958-1176617364\n3062064123-3063637314\n2087862269-2089342604\n1672729270-1679677272\n3733541117-3748642488\n3075188797-3083692289\n2520128380-2544925114\n1997250353-1999097991\n2326010770-2328459525\n3335649815-3359666038\n1093811055-1099676857\n1939453065-1940109461\n2260767055-2269509586\n1694740480-1710532828\n48862588-54135685\n2194651149-2194876489\n3261664286-3284505168\n712077073-718032346\n2714857640-2733949192\n3084808742-3090381388\n2326056027-2328734209\n2966286735-2970371217\n3682357002-3688783396\n222778070-246394155\n255495869-263746137\n778431350-801595041\n554816671-557769418\n2287063002-2290447136\n1204759607-1221061934\n3191695158-3195022731\n1937411520-1939682964\n3683208458-3683317560\n3724947613-3752969030\n2655947194-2686070304\n3319632926-3320555728\n3874349431-3892283480\n3524323559-3534255480\n3392910453-3425944137\n2864015808-2880343338\n3603278173-3607977481\n2221685432-2221741276\n3821784373-3831551419\n2340560220-2355630152\n117804595-135520674\n970739667-977759407\n612826307-617050682\n2420630784-2422511751\n4041221294-4053276651\n1783176414-1792788994\n1661820734-1672783713\n2285020555-2288812517\n1145717399-1147147799\n1160582338-1171067340\n2969768222-2978509720\n2241558918-2248366876\n3842088825-3849544675\n3220876335-3220899128\n3612828177-3614366172\n1848099469-1860064576\n1453352598-1457451860\n4131921387-4136290418\n1186411872-1221604187\n4271276227-4274727942\n1972041789-1977505124\n3130652998-3145750654\n4206797669-4211676679\n3382975599-3392910451\n3075497812-3098065611\n2819298198-2826283738\n1358156767-1363896494\n1209838280-1225553470\n3101724704-3130652996\n2874696153-2876992505\n1279193633-1279368007\n2044384098-2052585053\n1778896582-1783176412\n365291920-384429458\n1410453073-1423638312\n3149307838-3160666386\n3115765500-3124715535\n2524674650-2540040296\n312386716-315692662\n3195022733-3220876334\n1528945394-1531524966\n1190783271-1221823104\n1374677110-1382957599\n496392908-504137572\n3152103031-3191695157\n1706509680-1714907014\n2642314466-2645833233\n3893484464-3898889230\n3331226932-3338281520\n3421612598-3423251948\n2376098338-2382856038\n30669693-46887184\n3701470920-3709586949\n974101275-985095687\n3754694204-3762024757\n3199920021-3213832756\n3937237796-3943044170\n519102356-526718775\n3595418820-3608680530\n3132319868-3142292446\n2415135665-2422698971\n2512723394-2531872720\n2831177970-2843852399\n4067331024-4083628214\n974512957-981076935\n1939102143-1939797065\n3362465663-3382975598\n1081727915-1086599484\n62892604-66661231\n3596147589-3597403547\n2427949019-2455737031\n734503945-751972019\n4274360201-4275638496\n546152564-553124641\n1672412404-1675035441\n1799317782-1799878394\n3899929168-3902400564\n2090563035-2093365570\n2502990872-2504573807\n196879713-202383888\n1041219675-1045475560\n288505150-290311818\n2335068419-2337479072\n3115770397-3116114052\n1759780530-1779756738\n3848355565-3857570445\n2887262512-2892926939\n3297920188-3304753747\n2837362258-2846430149\n2365620967-2397295181\n2130880010-2144109636\n850356647-852183547\n2547575013-2555977963\n3293681014-3298307912\n2838677121-2848444483\n1378317671-1378385207\n3932893208-3942847442\n2775955760-2802739818\n3000621764-3001860005\n3878325586-3889110731\n1634960329-1635718125\n3570393129-3575649486\n3359666039-3362465661\n2221578838-2221700311\n307265752-314765240\n823227617-824317407\n923124066-946249854\n4151685721-4154340765\n424138334-424809502\n2057132501-2071060280\n647961093-660004652\n3307622347-3312520961\n3259939576-3281494745\n1887577612-1888900146\n1189371904-1198571936\n1234031907-1247954865\n610600287-612214510\n1630355907-1632283896\n1634415839-1636037634\n3824506379-3826246351\n3847566968-3849532976\n1588959146-1616167991\n4142261326-4149638559\n1813668039-1819668003\n269833124-284269645\n1445572315-1448859107\n3312520962-3326324517\n4134904662-4142261324\n286352057-295053323\n2093365572-2104458852\n2964496323-2978996654\n1589041634-1610897669\n4017779362-4023249218\n710580357-719926955\n3695217573-3697711534\n3119922419-3128398873\n1973300202-1979672054\n2647661251-2652365333\n1618800796-1618963161\n914189871-916240439\n70592825-75578072\n1931515004-1937254405\n2472726189-2479284501\n2073603890-2087967511\n4288162588-4289142874\n1651148640-1652304033\n384429459-393421986\n208944718-214460830\n250825858-254179572\n2845961347-2846405094\n3683052176-3689023082\n2548531964-2548558043\n3326324519-3343805565\n351155871-359398929\n4232721631-4250879475\n3459529479-3474108150\n1909441969-1909689691\n1932119221-1939290766\n2762860344-2765962584\n942511347-943894644\n3682865725-3687083046\n742172772-743598853\n382176907-388584692\n4086908517-4100905688\n2961073615-2978624771\n3753936484-3758588765\n357622008-361838888\n393421988-409475636\n4210437626-4216399302\n3866457812-3901968872\n943727563-944059707\n2919715277-2920771136\n1627803704-1630982586\n1111194889-1126815598\n1637697658-1639829508\n518330921-521079203\n558771603-558831008\n1627521188-1629733196\n2531822532-2533342258\n1722060329-1725371759\n916240441-923124065\n2267284366-2270810897\n4289142876-4294967295\n496711691-511059121\n297074742-300561489\n74957232-86751750\n67820201-89362971\n879194017-883306027\n874758234-886383957\n518363334-546855682\n606025974-631117297\n27195455-41332971\n2870905604-2878387377\n3084839165-3086179322\n4152483704-4155490661\n3992240000-3998336821\n3612662808-3613179304\n2144109637-2171654935\n2912881674-2913811866\n3683215934-3683776929\n744692065-746814759\n648698022-654389148\n770363291-773532218\n1961187739-1981201058\n833212292-844968840\n2279366266-2306861372\n1525437167-1529355367\n783203836-797187462\n743069797-747604954\n2726435221-2743671505\n716822331-723267087\n236924668-243049788\n1819907565-1821265293\n2459006570-2462769060\n261945027-269833122\n2251634561-2252542708\n3077512678-3082900025\n4178034955-4178140732\n517575846-518330919\n1833921219-1854646670\n1863586802-1867383721\n1688123912-1691016809\n3613097833-3613214641\n182210169-189009626\n299267101-339546807\n829601778-834904352\n481358143-505095971\n2224935194-2228740812\n4083628215-4105906366\n3938942245-3941751692\n983920144-989005805\n113931896-118379003\n3330676862-3358266446\n3778252069-3806861354\n751972021-764443450\n4108964080-4140242300\n1576228427-1585596252\n2268397999-2270766178\n1924059333-1931515003\n3938054379-3940855319\n4216399304-4232721630\n203859682-211512236\n1506317175-1508820099\n2082159387-2091680640\n3509536520-3513399808\n152981470-173147952\n1984109815-1997250352\n2104458853-2130880008\n2998034397-2999606176\n2081152422-2086162418\n1628568484-1631818535\n1469298549-1472797586\n2706655046-2709540287\n2171654937-2192635909\n3997842771-4006631146\n3806238246-3814481469\n3687035617-3693059533\n1714907016-1715546618\n2268214620-2268517442\n4168814485-4173314719\n4290592397-4294496881\n3026587742-3028212258\n109629716-117011951\n2227635708-2258663804\n4153336546-4157695457\n4183028054-4210437625\n1359555284-1365047163\n385317924-388866137\n956914163-980424242\n971923920-984657935\n3372104235-3387022483\n2459697795-2461023615\n4054424978-4061962114\n2531190780-2540332177\n981076936-984403766\n1943900205-1955571856\n1092170655-1096453697\n4188253293-4210273531\n1476473552-1484327172\n422306607-424937626\n3616461090-3629002324\n280581464-294914249\n1814486124-1821348543\n538601282-545721176\n4165166009-4178721021\n1988368657-1999218926\n3683738155-3686068920\n2339202139-2341973045\n1618530377-1618985589\n1061405927-1067161088\n1586686087-1588534608\n4187607606-4189350663\n1129004649-1138049175\n3769446976-3770072852\n2023963853-2036589722\n2154869719-2158914742\n4239846195-4246356778\n4051209708-4054424976\n2896089935-2914808278\n1435815375-1450285026\n145909747-170128283\n1885652106-1891564474\n1282644829-1292952382\n2286826126-2293672278\n818070038-841914149\n3335638754-3341961960\n1618857702-1619359406\n3939705062-3944559184\n2203145858-2219094358\n3769401246-3769482197\n2922943756-2925135318\n3468068444-3477636928\n3778956860-3790280017\n4073540020-4096504022\n3814481471-3828523511\n1415617645-1423826462\n3031527144-3033419898\n4062168143-4068151354\n1286492281-1286940405\n2428194387-2465453645\n801595042-817285567\n63581388-63635672\n4117266117-4119442082\n11602511-25799879\n1092570588-1093985932\n3296956776-3307622345\n2221567222-2221613969\n558232945-558709807\n3639754422-3650743589\n3437931121-3440846855\n3675035968-3681981311\n1433573245-1442758111\n1471139709-1473858291\n629519040-641689686\n4117209430-4119122433\n52713726-57736371\n2706992741-2707821184\n3602086332-3604188767\n3915139262-3922929260\n1634469269-1636558185\n2200025248-2210330662\n3521124209-3529596728\n1086599486-1093798819\n1309801249-1314575942\n3656835500-3663825208\n1519294415-1521662532\n3848027323-3849548785\n1907694975-1914277280\n1318019570-1322413873\n3338464003-3356847371\n3982076981-3997842770\n1267783432-1278940858\n1658689822-1678998548\n2857342978-2887262511\n4061962115-4062168141\n1459666268-1492181176\n2615378909-2638121319\n4134040495-4139294664\n1278940860-1279210793\n670672127-703998141\n1279368008-1294345099\n1816032308-1825117169\n5682-591077\n3367275968-3384214515\n64315567-67820199\n2502622426-2509648235\n2384858144-2400945744\n2328968349-2329640362\n3697104193-3697121849\n2192635910-2197813617\n948400714-955452470\n1616167993-1628568483\n2344207001-2347832306\n4065174279-4066995234\n2501136056-2507987954\n238478069-238584796\n2983949242-3005737605\n2500532521-2503210360\n1393768957-1418940970\n4267061677-4267804887\n1878114-2022850\n1632283898-1647333210\n2400945746-2409724446\n2869179197-2876746583\n1106490177-1115256489\n4061093101-4061131252\n2810396333-2822711292\n885348478-889915910\n1830435071-1837694596\n1837694597-1863586800\n2658513248-2682334850\n2924284916-2928154608\n2880061840-2880744733\n2598258370-2614301028\n2919390200-2945948816\n724929680-734503944\n2662412166-2665780598\n1178177517-1198965930\n1557905942-1573183772\n3563817129-3577035331\n486771190-517575845\n3645420942-3645846054\n703998143-706055398\n2004489841-2043681870\n2409724447-2427949017\n3620235480-3626019843\n1551168080-1572791868\n3438270145-3440465241\n2043792287-2048576193\n4189961855-4207923535\n1572791869-1573838792\n1560630061-1568705988\n1945995416-1972395216\n3154257326-3170804412\n2638121320-2639565458\n641909505-659715145\n706055399-724929678\n1322001994-1348241899\n178460965-196879712\n4290596074-4292022319\n951225450-964656102\n1286720286-1299664178\n4267798816-4281427565\n2473150224-2483209210\n1466959722-1495499946\n202383890-206442882\n2980151171-2982988832\n3724920258-3748749341\n3449375744-3467888004\n4793565-27195454\n2763578266-2769445414\n3551501696-3577270805\n103134511-108233928\n3985777319-3995983153\n4056112707-4056303018\n1113372127-1127291361\n3450126345-3475229161\n4289501916-4292619355\n2447323006-2456025596\n3080941568-3084548509\n3455764745-3467066059\n2180674525-2191641368\n4011611611-4029364618\n2171134-4793563\n315731014-335056809\n3397886846-3414158394\n2762557710-2767579504\n1521662534-1545573024\n1442758112-1459666266\n1415183222-1422510841\n1396869120-1432423701\n173147954-191770601\n307244055-331462148\n303700109-329107070\n3367139562-3375242354\n1257000697-1267783431\n3441110255-3441542687\n868214-1216244\n2348268821-2362581539\n135520676-152981469\n3590167439-3598674695\n1497010928-1519294414\n2990327259-3014332111\n1174787708-1178177515\n3724679263-3737472563\n3530672381-3532472131\n2337479073-2362367605\n204565716-213455559\n2725271867-2749432076\n3527158276-3529338030\n1732731-1878113\n2234307311-2250137487\n3503793539-3507292135\n2764054784-2767560591\n0-97802\n3497142772-3509229752\n2252345137-2252983294\n2511786509-2525437254\n534322385-552469473\n2032077105-2039311638\n1930871028-1935831989\n1999927802-2002593859\n2034870570-2046166201\n2416773420-2418971941\n2326019770-2327054298\n3587252557-3596385967\n3004640283-3006650230\n2504389437-2504604683\n1389927799-1393768955\n458800944-461346308\n1225553472-1229951958\n1901804609-1911376516\n628245201-636898070\n1241514379-1244482846\n1911376517-1924059331\n2179314-4534265\n2590117386-2604230483\n1171067342-1174787707\n1526785599-1531893226\n3055633094-3057199924\n1568124522-1572160758\n2966347008-2978486706\n54831687-66550552\n1550497473-1551168078\n2892926941-2903268722\n2771117187-2775955759\n1234521852-1241992108\n1691973028-1696406355\n2837877932-2849517138\n2480932114-2481698709\n2845946431-2846057821\n1233941434-1246198098\n3002861655-3005365109\n3434725509-3435993674\n2173341542-2184849378\n3896230707-3900645720\n822740965-823550270\n4110021562-4121150778\n63603171-63635151\n3132070451-3134002144\n4152899097-4154706289\n3072535465-3075497811\n2963912450-2969754776\n3143800036-3144360416\n3033532646-3059619065\n2870120437-2886869710\n3274547143-3278505007\n2749432077-2762094882\n1081689983-1081835641\n850604533-852396063\n238560784-238982766\n3023322565-3025688956\n54157058-66147301\n820647222-823031869\n2961003766-2967474817\n1576566644-1606323350\n2582544240-2595513897\n4151772914-4155462854\n71629773-74290540\n2762094884-2762897903\n3179890008-3180299038\n4012179467-4051209707\n1967679449-1971418911\n2845141471-2846053808\n2816320795-2827745715\n3780956085-3792190886\n3098898720-3099568383\n3275561729-3284901540\n1402054763-1425346693\n1070235712-1081689982\n2897914307-2900470075\n2823031175-2825449030\n3751706906-3751753267\n970815395-976275417\n47997723-60304756\n3794263864-3796550694\n2743705045-2750732810\n76689052-80924970\n2919462546-2939875618\n376886072-388318966\n1787682465-1808426641\n856379509-864589444\n2378537309-2380543166"

let parse_line s = match s |> String.split_on_char '-' |> List.map int_of_string with
  | [a;b] -> (a,b)
  | _ -> failwith "unreachable"

let rec merge_range ranges (a,b) = match ranges with
  | (c,d)::rs when d < a -> (c,d)::(merge_range rs (a,b))
  | (c,d)::rs when a-d < 2 && c-b < 2 -> merge_range rs (min a c, max b d)
  | (c,d)::rs -> (a,b)::(c,d)::rs
  | [] -> [(a,b)]

let rec count_missing res ranges = match ranges with
  | (_,b)::(c,d)::rs -> count_missing (res + c - b - 1) ((c,d)::rs)
  | _ -> res

let main () =
  let ranges = input |> Aoc.parse_lines parse_line in
  let merged_ranges = ranges |> List.fold_left merge_range [] in
  let part1 = merged_ranges |> List.hd |> snd |> (+) 1 |> string_of_int in
  let part2 = merged_ranges |> count_missing 0 |> string_of_int in
  (part1, part2)

let () = Aoc.timer main
