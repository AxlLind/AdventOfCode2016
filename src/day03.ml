let input = "  883  357  185\n  572  189  424\n  842  206  272\n   55  656   94\n  612  375   90\n  663  550  179\n  183  487  470\n  551  664  431\n  714  728  853\n  548  456  329\n  531  783  592\n   49  749  478\n  529  866  959\n   94  883   73\n  438   33  953\n  818  113  644\n  839  111  817\n   41   54  276\n   82  464  354\n  891  567  488\n  909  559  165\n  752   53   36\n  797  146  382\n  700   94  368\n  121  944  167\n  125  262  102\n  152  720  123\n  410  205  520\n  810  760  469\n  529  733  243\n  474  236  596\n  264  676  726\n  508  786  466\n  122  611  632\n  462  310  219\n  539  903  633\n  328  320  339\n  219  212  723\n  207  202  572\n  787  936  452\n  736  219  387\n  109  720  521\n  450   28  253\n  838  143   73\n  903  146  249\n  197  297  582\n  531  353  362\n  669  164  767\n  112  830  680\n  289  824  912\n  344   37  448\n  142  576   70\n  121  708  932\n   51  779  887\n  388  311  650\n  673  229  702\n  539  177  846\n  457  784  411\n   90  358  532\n  371  516  135\n   61  144  602\n  320  404  612\n  286  306  943\n  788  550  573\n  448  442  998\n  614  689  727\n  989  540  667\n  576  564  648\n  735   30  190\n  645  406  486\n  177  779  300\n  585  374  781\n  543  924  610\n  678  843  802\n  860  363  510\n   98  191  534\n  246  726  137\n  223  816  514\n  866  662  540\n  849  652  433\n  697  354  516\n   14  979  755\n  580  965  629\n  596  786  540\n  661  581  167\n  628  588  159\n   98  179    7\n   17  748  855\n  822   24  907\n  829  722  102\n  238  724  601\n  495  266  554\n  265  493  390\n  956  658  757\n  629  366  760\n  824  705  264\n  421  311  412\n  405   15  408\n   45  327  494\n  468  271  219\n  259  168  576\n  406  253  787\n  844  403  178\n  482  740   80\n  638  508  220\n  456  839  566\n  453   70  286\n  301  802  397\n  158  618  953\n  207  676  112\n  280  455  959\n  638  318   56\n  300  854  699\n  662  598  729\n  397  591  848\n  896  790  751\n  524  976  396\n  959  162    5\n  360  168   26\n  887  305   26\n   57  184  117\n  475  370  601\n  448  507  601\n  447  382  420\n  702  805  595\n  613  644  277\n  179  437  493\n  180  424  114\n  159  280  518\n  461   12  644\n   87  359  577\n  518  362  527\n  549  537  352\n  496  676  336\n  368  608   38\n  315  595  313\n  444  480  966\n  200  368  839\n   48  891  156\n   18  893  202\n   27  540   58\n   84  601  839\n  413   67  880\n  399  563  291\n  125  867  706\n  138  330   20\n   59  564  700\n  903  379  578\n  916  302  602\n  830  107   36\n  760  492  936\n  750  767  475\n  514  517  901\n  755  424  277\n  757  247  600\n  110  204  870\n  276  455  334\n  374  201   22\n  239  414  313\n  183  300  975\n  128  266   62\n   61   60  927\n  673  163  863\n  889  795  451\n  661  701  879\n  191  487  284\n  375  687  178\n  335  769  306\n  243  811  299\n  327  466  794\n  271  782  995\n  699  769  820\n  201  543  178\n  547  591  834\n  395  757  809\n  201  249  758\n  215  836  100\n   37  820  915\n  656  692  468\n  647  411  825\n  265   67  791\n  628  482  700\n  775  463  564\n  514  114  401\n  725  369  879\n  927  263  781\n  714  644  171\n  666  411  330\n  238  384  483\n  319    3  607\n  725  451  249\n  682  446  801\n  861  502  285\n  869  792  792\n  662  853  730\n  616  534  844\n  447  594  680\n  400   67  268\n  821  738  506\n  521  859  726\n  466  567  813\n  509  222  823\n  515   12  969\n  688  210  184\n  850  442  856\n  906  527   77\n  654  411  914\n  447  821  385\n  268  524  689\n  597  786  645\n  884   37  581\n  383  679  421\n  939  672  677\n  434  184  807\n   65  648  369\n  485  741  575\n  405  572  785\n  396  857  863\n   76  441  157\n  359  622  424\n  240  186  337\n  534  456   92\n  764  707  664\n  314  438  825\n  496  466  992\n  502  989  538\n  643  959  586\n  585  457  153\n   79  585  871\n   84  550  272\n  123  197  803\n  479  104  456\n  212  393  670\n  650  369  297\n  650  606  387\n  830  756  393\n  992  718   62\n   97  494  148\n  449  692  519\n  498  967  499\n   89  979  860\n   83  963  588\n   54   23  311\n  673  467  650\n  475  287  868\n  234  591  575\n  757  312  897\n  572  349  851\n  290  339  256\n  296  701  265\n  615  715  684\n  494  382  663\n  355  289  420\n  919  637  921\n  696  347  535\n  841  362  731\n  671  593  764\n  963  339  585\n  266  778  843\n  305  830  705\n  244  127  310\n  455  548  100\n  538  701  891\n  425  953  790\n  332   21  519\n  314  496  511\n   45  508   15\n  439  873  549\n  498  730  931\n  137  416  800\n  973  339  247\n  702  248  241\n  391  142    5\n  472  859  159\n  169  459  169\n  328  520  269\n  896   70  172\n  462  741  404\n  809  732  468\n  903  706   39\n  363  221  700\n  855  491  672\n  666  167  656\n  472  110  324\n  805  198  577\n  886   59  948\n  451  227  599\n  726  235  483\n  223   17  366\n  750   14  402\n  953   15  587\n  883  794  769\n  872  884   87\n  602  621  739\n  949  222  917\n  204  159  982\n  825  309  124\n  704  336   87\n  607  509  888\n  156  586  932\n  457  234  816\n  555  104  490\n  957  235  967\n  995   24  823\n  964  204  290\n  424  218  990\n  209  398  686\n  300  534  908\n  485  878  269\n   99  509  575\n  704  556  223\n  791  359  481\n  626  767   47\n  495  120   51\n  545  703   15\n  691  903  416\n  901  686  973\n  385  418  592\n  548  253  276\n  696  471  260\n  190  286  513\n  526   20  889\n  468  648   70\n  708  641  861\n  502  496  932\n  738  754  831\n  341  300  195\n  378  985  436\n  868  149  497\n  854  958  199\n  408  865  450\n  404  450  645\n   23  417  879\n  766  675   71\n  784  813  724\n  906  357  730\n  863  712  260\n  935  654  683\n  200  930  817\n  413  983  480\n  423  100  262\n  776  910  453\n  501  934  216\n  317  986  285\n  512  157  150\n  467  216  343\n  443  291  541\n  225  114  837\n  937  680  501\n  832  876  639\n  200  318  515\n    5  650  470\n    1  795  555\n    5  164  242\n   71  943   29\n  983  552    4\n  983  983   31\n  173  212  570\n  237  789  413\n  223  795  751\n  170  800  150\n  208  852  693\n  341  227  620\n  134  616  565\n   72  185  316\n  196  470  516\n  530  537  615\n  319  109  806\n  449  519  609\n  164  590  468\n  376  567  703\n  295   88  771\n  347  279    2\n  641  553  802\n  428  706  807\n  443  545  892\n  253  422  204\n  199  255  802\n  235  822  364\n  843  246  645\n  873  820  883\n  663  549  177\n  482  532  649\n  790  343  693\n  740  385  598\n  731  634  523\n   53  784   77\n  430  843  619\n  376  487  205\n  670  640  716\n  941  795  476\n   55  103  628\n  897  889  822\n  814  305  222\n  690  537  745\n  142  236  948\n  425  668  618\n  692  168  785\n  483  532  429\n  919  831  425\n  877  227  192\n  287  971  288\n  817  474  401\n  193   46  437\n  711  499   49\n  816  658  769\n  843  726  179\n   26  776  876\n   10  401  375\n  142  433  162\n  154  431  242\n  106  619  785\n  633  110  874\n  589  690  885\n  883  177  315\n  675  454  728\n  650  371  801\n  628   24  914\n  562  706   21\n  698  731  915\n  860  838  118\n  845  158  221\n   87  856  123\n  458  337  398\n  165  298  481\n  561  125  191\n   96  601  775\n  807  197  672\n  897  725  134\n  778  749  388\n  417  187  188\n  720  595  552\n  728  351  111\n  651  558  827\n  131  343  736\n  983  958  666\n  236  104  197\n  851  854  858\n  727  348  932\n  332  634  556\n  638  983  822\n  363  443    5\n  900  440   67\n  725  452   60\n  669   31  860\n  476  925  730\n  891  935  176\n  107  308  901\n  701  653  493\n  598  834  599\n  563  511  316\n  938  546  134\n  739   66  380\n  472  838  187\n  629  816  295\n  154  497  164\n  521  454  248\n  399  878  848\n  582  664  768\n  259  560  361\n  566  815  290\n  432  590  482\n  715  175  618\n  599   14   81\n  138  161  624\n  101   43  140\n  103  787    2\n  109  743  142\n  389  882  539\n   44  957  497\n  396  123   45\n  551  864  500\n  457  694  442\n  780  560  190\n  472  212  225\n  548  160   36\n  388   87  249\n  781  550  431\n  402   53  137\n  401  505  369\n   55  755  278\n  680   97  165\n  709  823  278\n  998   35   39\n  741  390  545\n  649  399  520\n  512  919  703\n   63  879  464\n  549  617  431\n  600  393  555\n  423  262  149\n  898  541  619\n  854  927  956\n  219  376  475\n  650  897  957\n  622  113  877\n  483  100  181\n  744   12  882\n  204  363  432\n   65    5   74\n  151  358  504\n  184  700  295\n  310  687   50\n  283  374  268\n  183  456  717\n  992    3  960\n  958  460  837\n  270  611   56\n  450    9  537\n  449  600  578\n  487  322  724\n  122  187  445\n  469  141  291\n  687  293  117\n  865  316  222\n  553   39  230\n  234  283   99\n  138  889  117\n  219  822   34\n  620  501  721\n  959  775  560\n  455  594  895\n  450  497  624\n  937  700  239\n  725  244  649\n  864  364   68\n  571  575  492\n  479  628  467\n  394  655  881\n  789  540  967\n  494  870  227\n  874  873  724\n  829  804  301\n   51   73  711\n  138  569  412\n  974  212  329\n  977  676  680\n  643  181  437\n   66  347  266\n  696  425  486\n  235  234  285\n  346  202  801\n  502   31  627\n  443  505  321\n  102  611   84\n  376  115  276\n  471  366  178\n  413  101  325\n   60  451  305\n  540  356  671\n   14  130  964\n  538  445  539\n  116  731  537\n  985  716  629\n  979  134  227\n  685  700   62\n  706  645  380\n   59  857  327\n  701  173  813\n  729  222  721\n   57  127  943\n  332  476  463\n  959  944  367\n  709  863  471\n  476  761  505\n  205  133  508\n  523  810   20\n   32  858  369\n  491  788  775\n  510  253  729\n   55  108  547\n  934  276  830\n  924  294  792\n   12  655  849\n  539  600  144\n  530   98  795\n  368  114  594\n  389  747  612\n  313  660  207\n  201  388  740\n  674  410  917\n  645  146  957\n  508  773  103\n  179  814  687\n  550  106  614\n  692  691  359\n  451  195  838\n  865  743  563\n  186  838  351\n   80   67  875\n  104  881  593\n  396  521  344\n  740  362  647\n  960  221  826\n  391  788  920\n  109  345  103\n  378  453  917\n  557  970  894\n  544  978  635\n   37  238  273\n  575  676  157\n  866  350  306\n  432  876  238\n  232  756   91\n  175  682  152\n  365  704  112\n  381  220   77\n   90  470  610\n  373  614  664\n  727  522  734\n  681  402  764\n   61  885   45\n  708  578  315\n  264  675  515\n  618  452  638\n  953  700  825\n  860  262  801\n  534  961  961\n  367  745  253\n  841  921  534\n  878  675  708\n  724  817  638\n  824  144  679\n  158  841  152\n  900  157   60\n  919  717  967\n   41  869  935\n  685  264   19\n  153  591  578\n  583  794  572\n  571  925  530\n  651  910  445\n  635  457  785\n  682   28  281\n  774  896   69\n  108  925  345\n  449  939  762\n  430    7   20\n   41  949  750\n  979  932  595\n  178  682  209\n  954  317  551\n  416  449  835\n  787  502  943\n  923  841  121\n  167   83  665\n  824   91  160\n  737   10  818\n  787  582  603\n  568  932  682\n  408  805  345\n   96  335  254\n  592  816   19\n  615  570  259\n   71  933  662\n  930  892  406\n  950  147  676\n  388  907  573\n  271  921  839\n  202   27  905\n  686  421  840\n  496  896  901\n  446  785   69\n  178  281  753\n  911  192  852\n  817  386  786\n   39  910  593\n  699  702  370\n  661  274  891\n  733  144  425\n  214   73  540\n  796  200  641\n  472  286  533\n  522  353  528\n  103  117   71\n  229  504   16\n  697  288  862\n  486  415  866\n  231  268  350\n  832  244  380\n  668  183  362\n  804  437  204\n  763  426  861\n  974  537  831\n  155   85  204\n  365  756  566\n  392  829  402\n  400   15  108\n  853  381  351\n  475  372  343\n  756  550  692\n  926  561  697\n  592   27  541\n  537  696  360\n  701   88  358\n  390  771  109\n  611  475  497\n  543  446  287\n  190  864  655\n  388  316  855\n  205  154  847\n  377  407   94\n  721  713  577\n  942  606  627\n  341  665  974\n  532  497  182\n  437  548  306\n  782   68  189\n  841  868  797\n  248  927   16\n  929  796  786\n  273  818  377\n  941  963  399\n  965  719   91\n  474   41  434\n  744  233   28\n  374  248  435\n  991    8  252\n  381  258  745\n  999  252  932\n  701  259  659\n  315  987  734\n  854  950  312\n  174  484  355\n  482  543  321\n  477  192  199\n  833  197  697\n  442  135  293\n  604   74  701\n  173  225  342\n  499  356   35\n  362  398  351\n  624  875  241\n  575  839  220\n  441   67  130\n  426  133  810\n  336   71  372\n  110  178  446\n   34   16  325\n  889  760  298\n  874  752   85\n  838  909  379\n  419  960   66\n  595   97  315\n  127  313  221\n  111  601   62\n  149  664  286\n  880  270   33\n  741  208  420\n  930  150  448\n  225  561  886\n  535  229  389\n  695  595  934\n  615  169  527\n  514  863  681\n  155  925  151\n  536  884   48\n  861  887  226\n  777   45  177\n  821  243  863\n  834  310  830\n  290  189   32\n  448  619  518\n  468  146  353\n   93  750  558\n  451  180  449\n  689  173  284\n  631  241  193\n  745  703  106\n  102   57  865\n  731  660  782\n  109  408  370\n  879  772  344\n  812  389  269\n   97  762  999\n  962  886  367\n  975  524  850\n  828   10  335\n  369  591  254\n  603  586  294\n  695  898   10\n  395  510  979\n  916  525  983\n  201  847  398\n  616  838  468\n  469  410  295\n  840  322  545\n  607  312  935\n  689    8  660\n  843   70  692\n  886  469  512\n  157  448  396\n  282  335  772\n  381  312  207\n  275  431  867\n  993  629  264\n  163  602  384\n  969   86  366\n  258   78  349\n  293  387   62\n   47  363  376\n  891  408  489\n  811  399  744\n  431   10  371\n  884  588  879\n  222  413  915\n  887  273  891\n  347  908  466\n  251  752  164\n  421  370  582\n   74  143  505\n  478   74  682\n  486  113  886\n  798  570  188\n  872  249  269\n  300  475  345\n  464  392    8\n  125  461  499\n  421  169  497\n  895  731  849\n  230  973  912\n  806  633  129\n  666  732  998\n  258  798  714\n  441   64  341\n  173  260  562\n  160  361  825\n  100  531  787\n  797  894  208\n   95  706  503\n  855  735  343\n  204  816  930\n  392   81  925\n  543  821   12\n  449  126  560\n  391  740  654\n  786  824  810\n  557   45  805\n  734  735  775\n  337  730  217\n  755   58  797\n  789  780  196\n   94  836  666\n   79  243  645\n   39  320  397\n  100   78  685\n  379  283   14\n  503  297  863\n  191   65  875\n  197  120   43\n  365  885  206\n  226  786  238\n  497  217   68\n  582   18  477\n  214  205  412\n  928  450  478\n  525  209  472\n  558  653  363\n   62  392  723\n  946  533  378\n  985  314  795\n  158  265  692\n  389  208  433\n  450  303  289\n  838  598  854\n  475  289  717\n  381  836  856\n  368  317  953\n  849   43  436\n  746  326  567\n  702   15  170\n  649  422  338\n  709  422  325\n  857  286  297\n  435  609  296\n  474  764   10\n  907  316  997\n  918    3  325\n  434  312  859\n   41  297  427\n  667  299  935\n  635    1  882\n  997  780  421\n  787  879   88\n  509  200  470\n  652  478  262\n  645  516   57\n   57  709  226\n  191  289  179\n  456  366  606\n  388   89  616\n  767  427  690\n  203  325  257\n  754  678  647\n  400  993  429\n  569  403  174\n  790  640  408\n  993  353  310\n  823  611  301\n  251  851  161\n  571  871  329\n  671  593  422\n  157  853  331\n  804  530  790\n  136  866  751\n  696  592  143\n  359  908  905\n  282   19  723\n  529  926  358\n  213  991  268\n  173  703  238\n  247  420   28\n  706  912  331\n  502  829  677\n  756  223  490\n  402  172  660\n  556  175  162\n  702  173  785\n  615  694  448\n  226    6  112\n  402  694  471\n   20  482  248\n   41  585  646\n   57  485  663\n  218  326  423\n  444  475  399\n  647  458  154\n  528  136  328\n  719  102   20\n  757  230  308\n   72  662  908\n  520  429  747\n  541  936  218\n  822  445  787\n  741  582  302\n  201  522  831\n  706   64  391\n  190  692  439\n  814  683  283\n   46  713  864\n  914  162  701\n  951  833  239\n  943  435  510\n  272   37  157\n  789  434  532\n  397  156  450\n  634  157  489\n  961   14  193\n  908  932  601\n  296   75  193\n  700  944  685\n  819   92   20\n  528  901  971\n  555  905  972\n  157  762   22\n  419  159  191\n  456  702  210\n  383  863  452\n  554  997  145\n  713  145  404\n  786   39  737\n  375  892  100\n  415  917  722\n  117  504  779\n  507  752  766\n  396  623   49\n  887  342   67\n  288  672  952\n  686  960  931\n  945  124  102\n  886  250  919\n  751  350  824\n  725  608  983\n  348  552  770\n  984  259  501\n  327  336  972\n  198  421  926\n  284  207  688\n  612  970  225\n  262  855  522\n  480  883  310\n  468  531   25\n  189  472  852\n  451  216  849\n  728  731   93\n  418  526  351\n  979  256  418\n  808  933  134\n  853  574  803\n  304  469  892\n  710  633  205\n  864  302   81\n  627  358  268\n  135  328  524\n  534  185  718\n  467  450  409\n  593  708  403\n   27   66  829\n  610  747  496\n  583  274  602\n  494  674  484\n  249  779  608\n  294  848  720\n  614  655  225\n  660  362  907\n  360  561  402\n  324   71   98\n  141  537  358\n  800  506  565\n  483  499  651\n  555   51  406\n  950  190  985\n  901  935  441\n  105  950  586\n  143  359  409\n  848  468  387\n  983  403  736\n  225  619  976\n  640  915  995\n  424  631   33\n  204  955  760\n  316  938  745\n  260   20  393\n   28  840  233\n  712  944  239\n  713  225   78\n  608  393  512\n  361  489  345\n  898  146  345\n  135  447   60\n  585  317   68\n  667  405   60\n   56  453  618\n  872  921   84\n  928  813  581\n  966  605  191\n  987  565  862\n  219  160  932\n  987  200  425\n  793  797  354\n  360  792  326\n  534  596  767\n  717  376  450\n  566  613  511\n  287  573  470\n  690  927  172\n  660  572  434\n  789   83  142\n   63  233  840\n  838  154  965\n  565  160  700\n  196  277  963\n  419  369  633\n  577  949  480\n  632  959  854\n  676   13  780\n  860  460  348\n    4  182  179\n  858  527  498\n  108  484  168\n  217  781  748\n  252  419  906\n  892  578  157\n  939  633   33\n  312  613  141\n   11  925  675\n   16  544  776\n   15  640  696\n  494  599  450\n  441  668  495\n  103  122   42\n  238  355  680\n  656  458  572\n  792  279  965\n  375  532  863\n  412  697  542\n  392  842  842\n  430  743  885\n  115  330  195\n  316  588  906\n  464  742  603\n  509  251  285\n  939  885  788\n   77  187  775\n  124  226   63\n   58   97  828\n  459  955  453\n  462  537  181\n  513  722  469\n  159  529  825\n  132  903  664\n  132  902  408\n  264  990  993\n  353  924  843\n  543  307  168\n  770   41  513\n  797  499  400\n  197  520  412\n  869  374  160\n  204  780  864\n  919  517  929\n  382  354  611\n  213  419  294\n  234  167  784\n  697  784  106\n  119  270  173\n  674  981  217\n  792  688  561\n   52  232  358\n  744  678  338\n  371  262  772\n  378   87  690\n  349  306  102\n   21  933  362\n  691  895  760\n  707   68  844\n  402  835  155\n  630  818  870\n  995  234  998\n  370  468  259\n  738  622  579\n  597  760  784\n  371  168  769\n  804  679  591\n  993  722  976\n  312  716  575\n  678  823  545\n  892  132  141\n  173  168  394\n  335  696  157\n  362  619  263\n  165  408  285\n  438  304  327\n  598  275  414\n    7  304  440\n  510  533   10\n  519  740  435\n  736  936  310\n  601  872  327\n  989  295  546\n  281  183  118\n  367  809  512\n  505  662  485\n  342  182  231\n  348  208  893\n   42  260  677\n  799  748  136\n  863  968  975\n  467  807  924\n  174  681  891\n  123  666  352\n  189   94  715\n  755  868  341\n  811  831  682\n   79  630  795\n  544  711  108\n  830  734  140\n  594  333   87\n  234  430  748\n  377  258  209\n  566  608  661\n  218  376  953\n  411  528  889\n  591  471  146\n   32  279  673\n  852  990  551\n  863  953  883\n  385  619  852\n  380  138   70\n   34  522  782\n  558  443  396\n  375  228  589\n  538  317  447\n  207  659  326\n  398  316  787\n  591  461  895\n  130  619  945\n  536  576  666\n  657  104  399\n  170  333  180\n  230  269  331\n  396  548  321\n  336  934  217\n  582  902  881\n  617  371  960\n  645  830  400\n  514  914  392\n  132  103   91\n   73   28  400\n   50  766  590\n   30  782  749\n  909  975  365\n  377  951  886\n  557  679  894\n  391  350  324\n  293   99  803\n  658  428  553\n  131   32  389\n  669  837  424\n  641  858  548\n  911  951  693\n  603  482  721\n  554  544  781\n  441  798  526\n  370  607  860\n  149  238  954\n  261  146  904\n  399  203  191\n  160  308  810\n  442  643  115\n  434  480  729\n  501  265  760\n  618  500  866\n  757   39   66\n  667  466  858\n  572  234  181\n  578  582  768\n   59  531  771\n  547  409  290\n  428  333  277\n  194  269   32\n  873  860  651\n  508  688  698\n  871  270  599\n   50  592  936\n  165  503  817\n  143  344  438\n  131  946  345\n  145  951  742\n  245  974  515\n  683  481  119\n  664  142  769\n  485  338  832\n   53  899  816\n  243   10  654\n  206  897  855\n   64   86  846\n   21  648  831\n   64  734  107\n   35  397  769\n   87  602  352\n   59  977  728\n  729  490  466\n  665  122  411\n   63  495  137\n  652  888   98\n  988   30  263\n  547  879  244\n  302  856  726\n  311  834  572\n  102  747  751\n  969  339  359\n  392  274  775\n  694  269  873\n   56  223  158\n  192  362  855\n  164  404  908\n   21  898  215\n  395  591  622\n  396  437  463\n  562  311  754\n  877  149  633\n  877  335  159\n  803  977  189\n  626   11   64\n  527  979  221\n  699  730  234\n  676   89  783\n  119  657  697\n  296  777  492\n  368  342  353\n  155  937  441\n  280   10  143\n  251  906  211\n   29  899   69\n  692   60  924\n  693  298  998\n    1  254  155\n  105  323  801\n  264  819  399\n  262  526  604\n  505  128  367\n  696  344  463\n  251  270  639\n  503  705  408\n  387   62  827\n  352  727  908\n   42  847  394\n  137   55   12\n  122  831  381\n  955  276  197\n  476  326  328\n  585  472  260\n  606  465   97\n  123  501  760\n  724  441  759\n   48  221  656\n  612  553  101\n  643  502  754\n  357  116  876\n  686  498  749\n  977  424  155\n  786  608  725\n  844  586  684\n  298  752  204\n  192  542  786\n  253  379  977\n  344  169  789\n  721  302  949\n   39   77  750\n  715  332  403\n  673  584  536\n  344  558  512\n  378   26  273\n  332  911  590\n   17  857  696\n  335  215  130\n    6  631  822\n  313  334  846\n  314  544  585\n  904  824   30\n  554  716  892\n  534  852  899\n   93  456   94\n   75  609  558\n   99  409  530\n  293  903  630\n  446    8  660\n  392  911   45\n  597  483  681\n  508  300  498\n  115  411  825\n  830  687  953\n  321  438   65\n  655  785  985\n  370  194  598\n  276  274  201\n  527  227  555\n  654  493  212\n  737  828  721\n  527  718  622\n  961  619  453\n   15  384  255\n  952  511  422\n  352  289  263\n  680  653  930\n  797  503  738\n  645  341  276\n   59  545  311\n  605  827   34\n  383  642  450\n   10  706   91\n  372  569  513\n  157  223  873\n  108  364  228\n  125  324  776\n  542  239  337\n  607  270  382\n  106  120  174\n  233  345  428\n  185  574   87\n  141  533  497\n  525  391  677\n  642  355   72\n  545  512  643\n  640  254  137\n  779  155  629\n  857  383  639\n  872  314  975\n  756  397  798\n  938  277  351\n  233  215  781\n  204  268  343\n  210   77  959\n  882  683  904\n   20  893  572\n  873  538  685\n   16  419  290\n  417  389  511\n  418   92  766\n  775  730  670\n  874  736  217\n  689  891  573\n  774  125  271\n  500  372  739\n  686  313  602\n  123   37  539\n   93  613  815\n   29  627  437\n  634  290  498\n  657  765  180\n  515  803  558\n  521  459  495\n  552  263  327\n  906  321  725\n  883  107  663\n  181   18  848\n  935  101  364\n  278  246  602\n  236  201  695\n   66  108  590\n  897  616  274\n  474  292  285\n  503  880  542\n  717  308  557\n  337  750  885\n  657  732  572\n  112  861  681\n   96  782  391\n   17  995  476\n    3  728  696\n  690  277  382\n  692  476  366\n  323  318  188\n   48  559  411\n  302  829  601\n  850  513  702\n  884  477   37\n   64  275  702\n   31  906  635\n  957  885  400\n  954  216  977\n  445  432  662\n  759  381  487\n  472  139  739\n  506  236  504\n  474  433  570\n  626  281  453\n  491  643  385\n   93  198  339\n  423  624   46\n  145   83  560\n  798  195  359\n  822  136  855\n  361  692  668\n  361  566  423\n   76  649  771\n  149  604  545\n  134  203  767\n  122  407  821\n   51  681  714\n  689  374  587\n  731  892  170\n  851  894  777\n   55  847  668\n  816   58  280\n  993  161  599\n  474  159  614\n  925  132  818\n  785  266  383\n  238  350  539\n  606  121  295\n  226  771  325\n  483  570  761\n  376  633  995\n   81  447  197\n  134  411  369\n  130  663  501\n  306  631  164\n  789  280   97\n  764  387  253\n  156  724  676\n  641   88  695\n  796  701  650\n  182  784   60\n  774  925  464\n  728  199  444\n  611  669   31\n  188  459  840\n  522  407  848\n   32  584  759\n  284  771  859\n  256  898  654\n  418   92  303\n  457  194  665\n  285  239  676\n  290  256  358\n  595  303  550\n  763  166  789\n  832  271  790\n  503  203  109\n  736  220  773\n  687  827  332\n  820  860  953\n  491   37  640\n  246  579  212\n  322  392  201\n  166  871   13\n  803  621  502\n  801  551  205\n   26  535  701\n  453  913  491\n  585  547   16\n  169  862  475\n  703  907  649\n  191  929  759\n  678  505  351\n  953  202  510\n  952  245  217\n  926   96  414\n  260  380  758\n  658  282  385\n  914  617  519\n  599  485  558\n  701  482  596\n  624    3  154\n  263  572  573\n  336  599  530\n  268   85  588\n   19  283  719\n  520  588  765\n  540  658  728\n  761  266  405\n  261  751  844\n  884  542  789\n  773  531  662\n  808  587  278\n   36  905  405\n  771  858  766\n  732  822  488\n  146  397  748\n  871  866  367\n  595  910  610\n  784  256  250\n  279  667  794\n  691  323  842\n  692  832  704\n  555  211  406\n  532   65  830\n  140  279  467\n  104  153   77\n  357  213  341\n  360  279  360\n  205  776  912\n  379  590   54\n  354  820  968\n  446  358  532\n  440  976  254\n   66  618  453\n  659  465  477\n  736  159  309\n  863  460  402\n  731  115  819\n  971  866  444\n  615  804  639\n  568  247  909\n  394  577  904\n  931  548   28\n  232  193  648\n  804  766  441\n  606  637  688\n   58  299  622\n  631  153  469\n  574  179  306\n  785  685   25\n  487  719  999\n  892  172  987\n  271  662  876\n  528  745  791\n  695  682  400\n  724  320  294\n   63  697  209\n  749  674  192\n  494  249   14\n  523   82  434\n   68  184  442\n   95  271  888\n  966  741  856\n  987  508  328\n  252  222  203\n    9  283  929\n  255  231  757\n  752  377  750\n  294  123  538\n  974  475  379\n  906  127  323\n  600  140  915\n  864   21  960\n  948  181   37\n  956  704  528\n   17  842  502\n  454   36  498\n  193  718  494\n  365  698   52\n  345  434   43\n  686  529    7\n  461  179   50\n  531  612  959\n  540  603  815\n    6  357  965\n   63   96  542\n  204  123  258\n  228   57  446\n  189  688  805\n  909  822  264\n  993  583  560\n  821  884  363\n  804  421  176\n   70  813  340\n  311  100  136\n  286  749   71\n   47  756   89\n   99  556  681\n  738  915  149\n  794  430  737\n  566  360  529\n  379  594  941\n  370  937  685\n  670  659  945\n  731  682  518\n  472  196  787\n   58  364   90\n  227  435  835\n  210  203  921\n   83  843  508\n  892  190  764\n  890  716  285\n  899  523  173\n   84  187  618\n  901  473  493\n  826  879  786\n  589  974  301\n  391  177  890\n  339  791  486\n  441  815   26\n  281  176  459\n  597  738  331\n  260  298  568\n  809  915  369\n  466  621  199\n  631  626  934\n  815  154  963\n  461  897  504\n  601  849  580\n  492  854  892\n  568  858   94\n  118  515  547\n  497  966  598\n  951  850  810\n  851  922  478\n  109  371  592\n  816  430  590\n  332  395  162\n  690  675  446\n  402  461  692\n  607  518  728\n  862  159  426\n  661  606  992\n  196  483  812\n  605  598  817\n  708  296  453\n  424  640  421\n  530  601  176\n  290   78  882\n  600  827  998\n  547  903  777\n  148  209  464\n  294  842  554\n  173  699   93\n  361  414  303\n  262  112  941\n  518  321  807\n  635  731  864\n  921  136  839\n  364  869  379\n  519  396  480\n  169  528  403\n  352  284  335\n  868  344  857\n  847  482  817\n  452  395   89\n  410  576   64\n  623   78  123\n  212  532   69\n  183  165  106\n  181  745  469\n  174  866  387\n  251  546  493\n  113  800  387\n  297  320  266\n  549  981  517\n  871  813  752\n  704  332  930\n  758  226  567\n   13  673  279\n  745  491  433\n  819  536  820\n  982  934  446\n  246  479  972\n  607  444  768\n  475  442  462\n  769    5  420\n   41  853  454\n  481  410  592\n  517  444  288\n  816  462  734\n   32  217  132\n  847  623  630\n  358  905  980\n  416  403   44\n  686  880  968\n  533  685  842\n  567  736  282\n  169  484  662\n  244  812  121\n  430  818  235\n  370  929  120\n  550  542  715\n  827   67  682\n  849  476  265\n  696  631  260\n  674  550  157\n  999  137  233\n  552  849   24\n  549  578  234\n   70  481  220\n  355  618  184\n  911  451  667\n  956  167  608\n  398   41  885\n  412  511  504\n   12  510  891\n  861  335  349\n  898  266  264\n   38  387  384\n  312  726  606\n  895  649  822\n  622  428  308\n  242  211  880\n  289   59  370\n  442  271  792\n   93  396  324\n  125  524  408\n   62  601  163\n  546  305  154\n  696  757  304\n  540  678  418\n  546  780  625\n  645  903  228\n  125  923  493\n  565  750  743\n  698  582  376\n  351  334  847\n  163  745  507\n  315   67  101\n  426  739  424\n  164  775  888\n  914  493  871\n  808  954   59\n  114  768  583\n  449  616  297\n  340  345  315\n  863  647   82\n  358  294   61\n  752  696  102\n   76  568  427\n  416  165  204\n  447  488  625\n   98  660  275\n  730  662   74\n  710  418  233\n  709  508   64\n  178  220  108\n  767  672   62\n  157  416  180\n  374  377  221\n  533  266  188\n  401    4  258\n  795  742  166\n  543  745  415\n  921  840  971\n  871  806  988\n   59  148   36\n  459  221  759\n  601  323  943\n  361  334  737\n  919   10  243\n  729  364  142\n  541  365  374\n  641  765  945\n  667  937  985\n  556  998  695\n  628  614  243\n  573  619  872\n  363  228  681\n  756  419  319\n   40  481  888\n  719  126  786\n  145  787  395\n   97  696  476\n   74  809  443\n  221  147  967\n  465  173  537\n  495   42  430\n  931  497  289\n   39  409  154\n  965  774  179\n  371  401  197\n  385  673  834\n  142  767  901\n  475  101  704\n  228  903  590\n  402  903  365\n  364  291  749\n  706  118  214\n  765  346  868\n  494  365  779\n  950  573  944\n  669  785  482\n  117  495  812\n  209  580  864\n  328  465  303\n  828  287  388\n  803  272  523\n  341   34  586\n  504  212  542\n  813  201   30\n  431  142  515\n  368  276  639\n  609  707  722\n  950  824  931\n   67  328  842\n   68  407  651\n   91  293  706\n  145  782  761\n   10  590  838\n  147  425  890\n  565  526  432\n  923  794  922\n  752  597  939\n  175  897  256\n  390   34  802\n  341  916  918\n  786  564  829\n  830  441  771\n  540  695   77\n  281  341   64\n  995  556  526\n  927  882  588\n  846  247   51\n  866   31  619\n   65  230  584\n  514  940  991\n  339  849  979\n  358  679   21\n  487  830  423\n  788  226  267\n  550  960  405\n   48  513  533\n   84  867  743\n  103  598  589\n  827  183   81\n  798  378  218\n  197  396  194\n  935  866  664\n  481  949  597\n  475  921  584\n  809  502  727\n  881  478  942\n  404  579  649\n  844  260  921\n  585  463  984\n  679  271  113\n  329  220  387\n  566   77  251\n  596  194  261\n  480  735  850\n  111  828  242\n  385  658  608\n  472  984  743\n  948  579  848\n  532  458  644\n  874  628   33\n  969  882  536\n  412  768  517\n  805  663  449\n  838  279  297\n  131  888  560\n  942  185  226\n  413  186  182\n  663   51   52\n   99  798  344\n  478  785  868\n  380   97  857\n   60  617  583\n   42  317  648\n  104  682  300\n  359  442  620\n  801  437  194\n  718   14  453\n  608  557  865\n  111   56  857\n  554  538   27\n  482  953  632\n  460   30  133\n   41  965  723\n  238  413  620\n  222  366   58\n  427  323  608\n  613  402  520\n  401  211  328\n  725  312  215"

let parse_line line = line |> Str.split (Str.regexp " +") |> List.map int_of_string in

let valid_triangle t =
  match List.sort compare t with
  | [a;b;c] -> a + b > c
  | _ -> failwith "unreachable"

let rec num_valid_columns list count = match list with
  | [a1;b1;c1]::[a2;b2;c2]::[a3;b3;c3]::xs ->
    let valid =
      (if valid_triangle [a1;a2;a3] then 1 else 0) +
      (if valid_triangle [b1;b2;b3] then 1 else 0) +
      (if valid_triangle [c1;c2;c3] then 1 else 0) in
    num_valid_columns xs (count + valid)
  | _ -> count

let main () =
  let lines = input |> Aoc.parse_lines parse_line in
  let part1 = lines |> List.filter valid_triangle |> List.length in
  let part2 = num_valid_columns lines 0 in
  (string_of_int part1, string_of_int part2)

let () = Aoc.timer main
